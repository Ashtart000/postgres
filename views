---VIEWS
--Нам потрібні всі юзери. Нам потрібно знати,скільки кожен юзер зробив замовлень

/*
CREATE VIEW name AS (
    query....
)
*/

CREATE OR REPLACE VIEW users_orders_amount AS (
    SELECT u.id, first_name, last_name, email, count(o.id) AS orders_amount FROM
    users AS u LEFT JOIN orders AS o
    ON u.id = o.customer_id
    GROUP BY u.id
    ORDER BY orders_amount
    );

SELECT * FROM users_orders_amount;

DROP VIEW users_orders_amount;

--Витягти всі email юзерів, які мають тільки 1 замовлення
SELECT * FROM users_orders_amount
WHERE orders_amount = 1;
